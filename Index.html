<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Math Quiz</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
  <style>
    body {
      padding: 1rem;
    }
    .quiz-container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .answers {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      width: 100%;
      max-width: 400px;
      margin-top: 1.5rem;
    }
    .answer-btn {
      width: 100%;
      height: 80px;
      font-size: 1.5rem;
    }
    .question {
      font-size: 2rem;
      margin: 1rem 0;
      text-align: center;
    }
  </style>
</head>
<body>
  <!-- Landing Page -->
  <section id="landing" class="section">
    <div class="container">
      <h1 class="title has-text-centered">Math Quiz Setup</h1>
      <div class="box">
        <form id="setupForm">
          <div class="field is-horizontal">
            <div class="field-label is-normal">
              <label class="label">Min Number</label>
            </div>
            <div class="field-body">
              <div class="field">
                <div class="control">
                  <input class="input" type="number" id="minRange" value="1">
                </div>
              </div>
            </div>
          </div>

          <div class="field is-horizontal">
            <div class="field-label is-normal">
              <label class="label">Max Number</label>
            </div>
            <div class="field-body">
              <div class="field">
                <div class="control">
                  <input class="input" type="number" id="maxRange" value="9">
                </div>
              </div>
            </div>
          </div>

          <div class="field is-horizontal">
            <div class="field-label is-normal">
              <label class="label">Game Time (mins)</label>
            </div>
            <div class="field-body">
              <div class="field">
                <div class="control">
                  <input class="input" type="number" id="gameTime" value="1">
                </div>
              </div>
            </div>
          </div>

          <div class="field is-horizontal">
            <div class="field-label is-normal">
              <label class="label">Question Timer (secs)</label>
            </div>
            <div class="field-body">
              <div class="field">
                <div class="control">
                  <input class="input" type="number" id="questionTime" value="5">
                </div>
              </div>
            </div>
          </div>

          <div class="field is-grouped is-grouped-centered">
            <div class="control">
              <button type="submit" class="button is-primary is-large">Start Quiz</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </section>

  <!-- Quiz Page -->
  <section id="quiz" class="section is-hidden">
    <div class="quiz-container">
      <div class="tags has-addons mb-3">
        <span class="tag is-dark is-medium">Time Left</span>
        <span id="timer" class="tag is-info is-medium">0</span>
      </div>
      <div class="tags has-addons mb-3">
        <span class="tag is-dark is-medium">Question Time</span>
        <span id="qTimer" class="tag is-warning is-medium">0</span>
      </div>
      <div class="tags has-addons mb-3">
        <span class="tag is-dark is-medium">Score</span>
        <span id="score" class="tag is-success is-medium">0/0</span>
      </div>
      <div id="question" class="question"></div>
      <div class="answers" id="answers"></div>
    </div>
  </section>

  <script>
    const landing = document.getElementById("landing");
    const quiz = document.getElementById("quiz");
    const form = document.getElementById("setupForm");
    const questionEl = document.getElementById("question");
    const answersEl = document.getElementById("answers");
    const timerEl = document.getElementById("timer");
    const qTimerEl = document.getElementById("qTimer");
    const scoreEl = document.getElementById("score");

    let minRange, maxRange, gameTime, questionTime;
    let correct = 0, total = 0;
    let gameInterval, questionInterval;
    let timeLeft, qTimeLeft;

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      minRange = parseInt(document.getElementById("minRange").value) || 1;
      maxRange = parseInt(document.getElementById("maxRange").value) || 9;
      gameTime = (parseInt(document.getElementById("gameTime").value) || 1) * 60;
      questionTime = parseInt(document.getElementById("questionTime").value) || 5;
      
      landing.classList.add("is-hidden");
      quiz.classList.remove("is-hidden");

      startGame();
    });

    function startGame() {
      correct = 0; total = 0;
      timeLeft = gameTime;
      scoreEl.textContent = `${correct}/${total}`;
      timerEl.textContent = timeLeft;
      gameInterval = setInterval(() => {
        timeLeft--;
        timerEl.textContent = timeLeft;
        if (timeLeft <= 0) {
          clearInterval(gameInterval);
          clearInterval(questionInterval);
          questionEl.textContent = "Game Over!";
          answersEl.innerHTML = "";
        }
      }, 1000);
      nextQuestion();
    }

    function nextQuestion() {
      clearInterval(questionInterval);
      qTimeLeft = questionTime;
      qTimerEl.textContent = qTimeLeft;
      questionInterval = setInterval(() => {
        qTimeLeft--;
        qTimerEl.textContent = qTimeLeft;
        if (qTimeLeft <= 0) {
          clearInterval(questionInterval);
          total++;
          scoreEl.textContent = `${correct}/${total}`;
          nextQuestion();
        }
      }, 1000);

      generateQuestion();
    }

    function generateQuestion() {
      let a = randomInt(minRange, maxRange);
      let b = randomInt(minRange, maxRange);
      let operator = Math.random() < 0.5 ? "+" : "-";
      let expressionType = randomInt(1, 3);
      let correctAnswer;

      if (operator === "-" && a < b) [a, b] = [b, a];

      if (operator === "+") {
        let result = a + b;
        if (expressionType === 1) {
          questionEl.textContent = `${a} + ? = ${result}`;
          correctAnswer = b;
        } else if (expressionType === 2) {
          questionEl.textContent = `? + ${b} = ${result}`;
          correctAnswer = a;
        } else {
          questionEl.textContent = `${a} + ${b} = ?`;
          correctAnswer = result;
        }
      } else {
        let result = a - b;
        if (expressionType === 1) {
          questionEl.textContent = `${a} - ? = ${result}`;
          correctAnswer = b;
        } else if (expressionType === 2) {
          questionEl.textContent = `? - ${b} = ${result}`;
          correctAnswer = a;
        } else {
          questionEl.textContent = `${a} - ${b} = ?`;
          correctAnswer = result;
        }
      }

      renderAnswers(correctAnswer);
    }

    function renderAnswers(correctAnswer) {
      answersEl.innerHTML = "";
      let options = new Set([correctAnswer]);
      while (options.size < 4) {
        options.add(randomInt(minRange, maxRange));
      }
      let shuffled = Array.from(options).sort(() => Math.random() - 0.5);

      shuffled.forEach(opt => {
        let btn = document.createElement("button");
        btn.className = "button is-light is-large is-rounded answer-btn";
        btn.textContent = opt;
        btn.onclick = () => checkAnswer(btn, opt, correctAnswer);
        answersEl.appendChild(btn);
      });
    }

    function checkAnswer(btn, chosen, correctAnswer) {
      total++;
      if (chosen === correctAnswer) {
        correct++;
        btn.classList.remove("is-light");
        btn.classList.add("is-success");
        document.body.style.backgroundColor = "#d4edda";
      } else {
        btn.classList.remove("is-light");
        btn.classList.add("is-danger");
        document.body.style.backgroundColor = "#f8d7da";
      }
      scoreEl.textContent = `${correct}/${total}`;
      clearInterval(questionInterval);
      setTimeout(() => {
        document.body.style.backgroundColor = "white";
        nextQuestion();
      }, 700);
    }

    function randomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }
  </script>
</body>
</html>
